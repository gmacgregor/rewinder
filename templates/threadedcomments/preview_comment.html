{% extends "base.html" %}
{% block title %}Preview your comment{% endblock %}
{% load threadedcommentstags %}

{% block content %}
{% if comment %}
{% load gravatar %}
{% get_gravatar_url for comment.email as gravatar %}
<div id="comment_preview">
<h2>Here's what your comment will look like:</h2>
<div class="comment">
<p>{% if comment.website %}<a href="{{ comment.website }}">{% endif %}<img src="{{ comment.email|gravatar }}" alt="Gravatar for {{ comment.name }}" />{% if comment.website %}</a>{% endif %}{% if comment.website %}<a href="{{ comment.website }}">{% endif %}{{ comment.name }}{% if comment.website %}</a>{% endif %}</p>
{% auto_transform_markup comment %}
</div>
</div>
{% endif %}

{% if form.errors %}
<p>Slow down, Tiger!</p>
<ul class="errorlist">
{% for error in form.errors %}
    {% ifequal error "name" %}
    <li>Your name is required</li>
    {% endifequal %}
    {% ifequal error "comment" %}
    <li>A comment is required (duh!)</li>
    {% endifequal %}
    {% ifequal error "website" %}
    <li>You need to format your website url like: http://www.example.com</li>
    {% endifequal %}
    {% ifequal error "email" %}
    <li>The format of your email address is invalid</li>
    {% endifequal %}
{% endfor %}
</ul>
{% endif %}
<form method="post" action="" id="comment-form">
    <p><label for="id_comment">Comment</label>{{ form.comment }}</p>
    <p><label for="id_name">Name</label>{{ form.name }}</p>
    <p><label for="id_email">Email</label>{{ form.email }}</p>
    <p><label for="id_website">Website</label>{{ form.website }}</p>
    <input type="submit" name="preview" value="Preview" />
    <input type="submit" name="post" value="Post" />
    <input type="hidden" name="next" value="{{ next }}" />
</form>
{% endblock %}